<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="Definitions_1k74nr7" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="3.7.1">
  <bpmn:process id="POD_AGENT" name="POD_AGENT" isExecutable="true">
    <bpmn:startEvent id="startEvent">
      <bpmn:outgoing>SequenceFlow_05ce5l4</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:sequenceFlow id="SequenceFlow_05ce5l4" sourceRef="startEvent" targetRef="changeTaskStatusToDepositInProgressTask" />
    <bpmn:receiveTask id="receivePaidStatusTask" name="Receive PAID status" camunda:asyncAfter="true" camunda:exclusive="false" messageRef="Message_10hxti9">
      <bpmn:incoming>SequenceFlow_1h0wm2l</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0tbzgcy</bpmn:outgoing>
    </bpmn:receiveTask>
    <bpmn:sequenceFlow id="SequenceFlow_0tbzgcy" sourceRef="receivePaidStatusTask" targetRef="changeTaskStatusToPaidTask" />
    <bpmn:endEvent id="endEvent">
      <bpmn:incoming>SequenceFlow_0d57cje</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:serviceTask id="changeTaskStatusToDepositInProgressTask" name="Change task status" camunda:asyncBefore="true" camunda:exclusive="false" camunda:delegateExpression="${changePaymentTaskStatusTask}">
      <bpmn:extensionElements>
        <camunda:failedJobRetryTimeCycle>R3/PT5M</camunda:failedJobRetryTimeCycle>
        <camunda:inputOutput>
          <camunda:inputParameter name="paymentTaskStatus">DEPOSIT_IN_PROGRESS</camunda:inputParameter>
          <camunda:inputParameter name="paymentTaskId">${paymentTaskId}</camunda:inputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_05ce5l4</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_173hjg4</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="changeTaskStatusToGiveAwayInProgressTask" name="Change task status" camunda:asyncBefore="true" camunda:exclusive="false" camunda:delegateExpression="${changePaymentTaskStatusTask}">
      <bpmn:extensionElements>
        <camunda:failedJobRetryTimeCycle>R3/PT5M</camunda:failedJobRetryTimeCycle>
        <camunda:inputOutput>
          <camunda:inputParameter name="paymentTaskStatus">GIVEAWAY_IN_PROGRESS</camunda:inputParameter>
          <camunda:inputParameter name="paymentTaskId">${paymentTaskId}</camunda:inputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_0l7ilby</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1txn1bi</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="changeTaskStatusToDepositGiveAwayDoneTask" name="Change status" camunda:asyncBefore="true" camunda:exclusive="false" camunda:delegateExpression="${changePaymentTaskStatusTask}">
      <bpmn:extensionElements>
        <camunda:failedJobRetryTimeCycle>R3/PT5M</camunda:failedJobRetryTimeCycle>
        <camunda:inputOutput>
          <camunda:inputParameter name="paymentTaskStatus">DEPOSIT_AND_GIVEAWAY_DONE</camunda:inputParameter>
          <camunda:inputParameter name="paymentTaskId">${paymentTaskId}</camunda:inputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_0rt96dw</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1h0wm2l</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="SequenceFlow_1h0wm2l" sourceRef="changeTaskStatusToDepositGiveAwayDoneTask" targetRef="receivePaidStatusTask" />
    <bpmn:serviceTask id="changeTaskStatusToPaidTask" name="Change status" camunda:asyncBefore="true" camunda:exclusive="false" camunda:delegateExpression="${changePaymentTaskStatusTask}">
      <bpmn:extensionElements>
        <camunda:failedJobRetryTimeCycle>R3/PT5M</camunda:failedJobRetryTimeCycle>
        <camunda:inputOutput>
          <camunda:inputParameter name="paymentTaskStatus">PAID</camunda:inputParameter>
          <camunda:inputParameter name="paymentTaskId">${paymentTaskId}</camunda:inputParameter>
        </camunda:inputOutput>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_0tbzgcy</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0d57cje</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="SequenceFlow_0d57cje" sourceRef="changeTaskStatusToPaidTask" targetRef="endEvent" />
    <bpmn:sequenceFlow id="SequenceFlow_1txn1bi" sourceRef="changeTaskStatusToGiveAwayInProgressTask" targetRef="createGiveAwayTask" />
    <bpmn:serviceTask id="createGiveAwayTask" name="Create give-away object" camunda:asyncBefore="true" camunda:exclusive="false" camunda:delegateExpression="${createPaymentGiveAwayTask}">
      <bpmn:extensionElements>
        <camunda:failedJobRetryTimeCycle>R3/PT5M</camunda:failedJobRetryTimeCycle>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_1txn1bi</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1nbdxs6</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="SequenceFlow_1nbdxs6" sourceRef="createGiveAwayTask" targetRef="tpNetGiveAwayCallActivity" />
    <bpmn:sequenceFlow id="SequenceFlow_0rt96dw" sourceRef="tpNetGiveAwayCallActivity" targetRef="changeTaskStatusToDepositGiveAwayDoneTask" />
    <bpmn:sequenceFlow id="SequenceFlow_0l7ilby" sourceRef="tpNetDepositCallActivity" targetRef="changeTaskStatusToGiveAwayInProgressTask" />
    <bpmn:sequenceFlow id="SequenceFlow_173hjg4" sourceRef="changeTaskStatusToDepositInProgressTask" targetRef="tpNetDepositCallActivity" />
    <bpmn:callActivity id="tpNetDepositCallActivity" name="Run deposit TPNET process" camunda:asyncBefore="true" camunda:exclusive="false" calledElement="TP_NET_INTERACTION">
      <bpmn:extensionElements>
        <camunda:in businessKey="#{execution.getVariable(&#34;paymentTaskId&#34;)}" />
        <camunda:in source="paymentTaskId" target="paymentTaskId" />
        <camunda:in sourceExpression="DEPOSIT" target="tpNetType" />
        <camunda:in sourceExpression="POD_AGENT_DEPOSIT" target="incidentType" />
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_173hjg4</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0l7ilby</bpmn:outgoing>
    </bpmn:callActivity>
    <bpmn:callActivity id="tpNetGiveAwayCallActivity" name="Run giveAway TPNET process" camunda:asyncBefore="true" camunda:exclusive="false" calledElement="TP_NET_INTERACTION">
      <bpmn:extensionElements>
        <camunda:in businessKey="#{execution.getVariable(&#34;giveAwayId&#34;)}" />
        <camunda:in source="paymentTaskId" target="paymentTaskId" />
        <camunda:in sourceExpression="GIVEAWAY" target="tpNetType" />
        <camunda:in sourceExpression="POD_AGENT_GIVEAWAY" target="incidentType" />
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_1nbdxs6</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0rt96dw</bpmn:outgoing>
    </bpmn:callActivity>
    <bpmn:textAnnotation id="TextAnnotation_14tqm66">
      <bpmn:text>status = DEPOSIT_IN_PROGRESS</bpmn:text>
    </bpmn:textAnnotation>
    <bpmn:association id="Association_0vmipaw" sourceRef="changeTaskStatusToDepositInProgressTask" targetRef="TextAnnotation_14tqm66" />
    <bpmn:textAnnotation id="TextAnnotation_01r4r6v">
      <bpmn:text>status = GIVEAWAY_IN_PROGRESS</bpmn:text>
    </bpmn:textAnnotation>
    <bpmn:association id="Association_1lv0v2s" sourceRef="changeTaskStatusToGiveAwayInProgressTask" targetRef="TextAnnotation_01r4r6v" />
    <bpmn:textAnnotation id="TextAnnotation_07uqcvo">
      <bpmn:text>status = DEPOSIT_AND_GIVEAWAY_DONE</bpmn:text>
    </bpmn:textAnnotation>
    <bpmn:association id="Association_1og5vy9" sourceRef="changeTaskStatusToDepositGiveAwayDoneTask" targetRef="TextAnnotation_07uqcvo" />
    <bpmn:textAnnotation id="TextAnnotation_1be8aqb">
      <bpmn:text>status = PAID</bpmn:text>
    </bpmn:textAnnotation>
    <bpmn:association id="Association_1csb9fz" sourceRef="changeTaskStatusToPaidTask" targetRef="TextAnnotation_1be8aqb" />
    <bpmn:textAnnotation id="TextAnnotation_0oritim">
      <bpmn:text>businessKey = giveAwayId
tpNetType = GIVEAWAY
incidentType = POD_AGENT_GIVEAWAY
</bpmn:text>
    </bpmn:textAnnotation>
    <bpmn:association id="Association_1njhd80" sourceRef="tpNetGiveAwayCallActivity" targetRef="TextAnnotation_0oritim" />
    <bpmn:textAnnotation id="TextAnnotation_1wnao42">
      <bpmn:text>businessKey = paymentTaskId
tpNetType = DEPOSIT
incidentType = POD_AGENT_DEPOSIT</bpmn:text>
    </bpmn:textAnnotation>
    <bpmn:association id="Association_171fb9j" sourceRef="tpNetDepositCallActivity" targetRef="TextAnnotation_1wnao42" />
    <bpmn:textAnnotation id="TextAnnotation_18vk66s">
      <bpmn:text>Receive PAID status from Billing Interaction</bpmn:text>
    </bpmn:textAnnotation>
    <bpmn:association id="Association_1pkg18c" sourceRef="receivePaidStatusTask" targetRef="TextAnnotation_18vk66s" />
  </bpmn:process>
  <bpmn:message id="Message_1hkqxrb" name="tpnetGiveAwaySuccess" />
  <bpmn:message id="Message_0cw2q81" name="tpnetGiveAwayFail" />
  <bpmn:message id="Message_0umvsoc" name="tpnetDepositSuccess" />
  <bpmn:message id="Message_06poa4p" name="tpnetDepositFail" />
  <bpmn:message id="Message_0gc7vaq" name="Message_0uqu1lo" />
  <bpmn:message id="Message_10hxti9" name="billingPaidStatus" />
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="POD_AGENT">
      <bpmndi:BPMNEdge id="SequenceFlow_173hjg4_di" bpmnElement="SequenceFlow_173hjg4">
        <di:waypoint x="430" y="277" />
        <di:waypoint x="490" y="277" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0l7ilby_di" bpmnElement="SequenceFlow_0l7ilby">
        <di:waypoint x="590" y="277" />
        <di:waypoint x="660" y="277" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0rt96dw_di" bpmnElement="SequenceFlow_0rt96dw">
        <di:waypoint x="1100" y="277" />
        <di:waypoint x="1170" y="277" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1nbdxs6_di" bpmnElement="SequenceFlow_1nbdxs6">
        <di:waypoint x="930" y="277" />
        <di:waypoint x="1000" y="277" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1txn1bi_di" bpmnElement="SequenceFlow_1txn1bi">
        <di:waypoint x="760" y="277" />
        <di:waypoint x="830" y="277" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0d57cje_di" bpmnElement="SequenceFlow_0d57cje">
        <di:waypoint x="1600" y="277" />
        <di:waypoint x="1652" y="277" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1h0wm2l_di" bpmnElement="SequenceFlow_1h0wm2l">
        <di:waypoint x="1270" y="277" />
        <di:waypoint x="1340" y="277" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0tbzgcy_di" bpmnElement="SequenceFlow_0tbzgcy">
        <di:waypoint x="1440" y="277" />
        <di:waypoint x="1500" y="277" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_05ce5l4_di" bpmnElement="SequenceFlow_05ce5l4">
        <di:waypoint x="268" y="277" />
        <di:waypoint x="330" y="277" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="startEvent">
        <dc:Bounds x="232" y="259" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ReceiveTask_0jqay7n_di" bpmnElement="receivePaidStatusTask">
        <dc:Bounds x="1340" y="237" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_1cw3eig_di" bpmnElement="endEvent">
        <dc:Bounds x="1652" y="259" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_0luqnp7_di" bpmnElement="changeTaskStatusToDepositInProgressTask">
        <dc:Bounds x="330" y="237" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_0nziz84_di" bpmnElement="changeTaskStatusToGiveAwayInProgressTask">
        <dc:Bounds x="660" y="237" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_1mu09zd_di" bpmnElement="changeTaskStatusToDepositGiveAwayDoneTask">
        <dc:Bounds x="1170" y="237" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_1ear4cf_di" bpmnElement="changeTaskStatusToPaidTask">
        <dc:Bounds x="1500" y="237" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_09cqrrt_di" bpmnElement="createGiveAwayTask">
        <dc:Bounds x="830" y="237" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_14tqm66_di" bpmnElement="TextAnnotation_14tqm66">
        <dc:Bounds x="160" y="146" width="217" height="30" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_01r4r6v_di" bpmnElement="TextAnnotation_01r4r6v">
        <dc:Bounds x="650" y="148" width="217" height="26" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_07uqcvo_di" bpmnElement="TextAnnotation_07uqcvo">
        <dc:Bounds x="1120" y="113" width="217" height="39" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_1be8aqb_di" bpmnElement="TextAnnotation_1be8aqb">
        <dc:Bounds x="1523" y="171" width="100" height="30" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_0oritim_di" bpmnElement="TextAnnotation_0oritim">
        <dc:Bounds x="900" y="100" width="234" height="82" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_1wnao42_di" bpmnElement="TextAnnotation_1wnao42">
        <dc:Bounds x="410" y="115" width="217" height="68" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_18vk66s_di" bpmnElement="TextAnnotation_18vk66s">
        <dc:Bounds x="1360" y="120" width="140" height="39" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1no5e5n_di" bpmnElement="tpNetDepositCallActivity">
        <dc:Bounds x="490" y="237" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0jgypvi_di" bpmnElement="tpNetGiveAwayCallActivity">
        <dc:Bounds x="1000" y="237" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Association_0vmipaw_di" bpmnElement="Association_0vmipaw">
        <di:waypoint x="357" y="237" />
        <di:waypoint x="278" y="176" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Association_1lv0v2s_di" bpmnElement="Association_1lv0v2s">
        <di:waypoint x="729" y="237" />
        <di:waypoint x="753" y="174" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Association_1og5vy9_di" bpmnElement="Association_1og5vy9">
        <di:waypoint x="1220" y="237" />
        <di:waypoint x="1229" y="152" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Association_1csb9fz_di" bpmnElement="Association_1csb9fz">
        <di:waypoint x="1541" y="237" />
        <di:waypoint x="1541" y="201" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Association_1njhd80_di" bpmnElement="Association_1njhd80">
        <di:waypoint x="1040" y="237" />
        <di:waypoint x="1027" y="182" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Association_171fb9j_di" bpmnElement="Association_171fb9j">
        <di:waypoint x="533" y="237" />
        <di:waypoint x="524" y="183" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Association_1pkg18c_di" bpmnElement="Association_1pkg18c">
        <di:waypoint x="1402" y="237" />
        <di:waypoint x="1424" y="159" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
